<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网络监控指标问答</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2 {
            color: #2c3e50;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        .qa-item {
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
        }
        .question {
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .answer {
            margin-left: 20px;
        }
        code {
            background: #f1f1f1;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .note {
            background: #e1f5fe;
            padding: 15px;
            border-left: 4px solid #03a9f4;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>网络监控指标问答文档</h1>

    <div class="qa-item">
        <div class="question">Q: 系统能监控哪些网卡的流量？</div>
        <div class="answer">
            <p>系统通过eBPF的XDP程序和网卡管理器可以监控以下类型的网卡：</p>
            <ul>
                <li>物理网卡（如eth0, en0等）</li>
                <li>虚拟网卡（可配置是否监控）</li>
                <li>Docker网卡（可配置是否监控）</li>
                <li>回环接口（可配置是否监控）</li>
            </ul>
            <div class="note">
                通过配置文件可以灵活控制要监控的网卡类型，支持黑白名单机制。
            </div>
        </div>
    </div>

    <div class="qa-item">
        <div class="question">Q: 系统收集了哪些指标数据？</div>
        <div class="answer">
            <h3>1. Agent基础信息</h3>
            <pre>
AgentID     - Agent唯一标识
StartupTime - Agent启动时间
ReportTime  - 本次上报时间
ReportMode  - 上报模式（固定为incremental）</pre>

            <h3>2. 域名相关指标</h3>
            <pre>
Domain          - 域名
AccessCount     - 访问次数
BytesSent      - 发送字节数
BytesReceived  - 接收字节数
ConnectionCount - 连接数
LastAccessTime  - 最后访问时间
ProtocolStats   - 协议分布统计
PortStats      - 端口分布统计</pre>

            <h3>3. 系统级指标</h3>
            <pre>
Hostname           - 主机名
Interface          - 监控的网卡名称
TotalConnections   - 总连接数
TotalBytesSent     - 总发送字节数
TotalBytesReceived - 总接收字节数
ActiveDomains      - 活跃域名数量
ReportInterval     - 上报间隔
UptimeSeconds      - 运行时长（秒）</pre>

            <h3>4. 元数据信息</h3>
            <pre>
Version            - Agent版本
ConfigHash         - 配置文件哈希值
Tags               - 自定义标签
PersistenceEnabled - 是否启用持久化
RestartDetected    - 是否检测到重启</pre>
        </div>
    </div>

    <div class="qa-item">
        <div class="question">Q: 如何处理数据上报和累计？</div>
        <div class="answer">
            <p>系统采用纯增量上报模式：</p>
            <ul>
                <li>客户端只上报增量数据（自上次上报以来的变化）</li>
                <li>服务端负责数据累计和聚合</li>
                <li>通过持久化机制确保Agent重启不丢失数据</li>
            </ul>

            <h3>服务端存储结构</h3>
            <pre>
RawMetrics       - 保存原始的增量数据
GlobalCumulative - 服务端计算的全局累计数据
RestartBaselines - 处理Agent重启场景
AgentStates      - 跟踪Agent状态</pre>

            <div class="note">
                <p>采用纯增量模式的优势：</p>
                <ul>
                    <li>减少数据传输量</li>
                    <li>简化客户端逻辑</li>
                    <li>保持数据准确性</li>
                    <li>服务端可以更灵活地处理数据</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="qa-item">
        <div class="question">Q: 如何配置监控范围？</div>
        <div class="answer">
            <p>通过配置文件可以精确控制监控范围：</p>
            <pre>
# 协议监控
protocols:
  - tcp
  - udp
  - http
  - https
  - dns

# 过滤规则
filters:
  ignore_localhost: true
  ignore_ports:
    - 22    # SSH
    - 123   # NTP
  ignore_ips:
    - "127.0.0.1"
    - "::1"
  ignore_domains:
    - "*.amazonaws.com"
  only_domains: []  # 指定后只监控这些域名</pre>
        </div>
    </div>

</body>
</html> 