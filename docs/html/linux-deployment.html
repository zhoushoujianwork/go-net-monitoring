<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go Network Monitoring - Linux äºŒè¿›åˆ¶éƒ¨ç½²æŒ‡å—</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 10px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .section {
            background: white;
            margin-bottom: 30px;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .section h3 {
            color: #34495e;
            margin: 25px 0 15px 0;
            font-size: 1.3em;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .code-block .comment {
            color: #68d391;
        }
        
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .download-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .download-btn {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            margin: 10px;
            transition: background 0.3s;
        }
        
        .download-btn:hover {
            background: #218838;
        }
        
        .architecture-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .arch-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .toc h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .toc ul {
            list-style: none;
        }
        
        .toc li {
            margin: 8px 0;
        }
        
        .toc a {
            color: #3498db;
            text-decoration: none;
            padding: 5px 0;
            display: block;
        }
        
        .toc a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .footer {
            text-align: center;
            padding: 30px;
            color: #666;
            border-top: 1px solid #eee;
            margin-top: 50px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ Go Network Monitoring</h1>
            <p>Linux äºŒè¿›åˆ¶éƒ¨ç½²æŒ‡å— - é«˜æ€§èƒ½ç½‘ç»œæµé‡ç›‘æ§ç³»ç»Ÿ</p>
        </div>

        <div class="download-section">
            <h2>ğŸ“¦ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬</h2>
            <p>ä» GitHub Release ä¸‹è½½é¢„ç¼–è¯‘çš„ Linux äºŒè¿›åˆ¶æ–‡ä»¶</p>
            <a href="https://github.com/zhoushoujianwork/go-net-monitoring/releases/latest" class="download-btn">
                ğŸ“¥ ä¸‹è½½ Linux x86_64
            </a>
            <a href="https://github.com/zhoushoujianwork/go-net-monitoring/releases" class="download-btn">
                ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬
            </a>
        </div>

        <div class="toc">
            <h3>ğŸ“‹ ç›®å½•</h3>
            <ul>
                <li><a href="#requirements">ç³»ç»Ÿè¦æ±‚</a></li>
                <li><a href="#download">ä¸‹è½½å®‰è£…</a></li>
                <li><a href="#configuration">é…ç½®æ–‡ä»¶</a></li>
                <li><a href="#deployment">éƒ¨ç½²æ–¹å¼</a></li>
                <li><a href="#monitoring">ç›‘æ§éªŒè¯</a></li>
                <li><a href="#troubleshooting">æ•…éšœæ’æŸ¥</a></li>
                <li><a href="#advanced">é«˜çº§é…ç½®</a></li>
            </ul>
        </div>

        <div class="section" id="requirements">
            <h2>ğŸ”§ ç³»ç»Ÿè¦æ±‚</h2>
            
            <h3>æ”¯æŒçš„æ“ä½œç³»ç»Ÿ</h3>
            <div class="architecture-grid">
                <div class="arch-card">
                    <h4>ğŸ§ Ubuntu/Debian</h4>
                    <p>Ubuntu 18.04+ / Debian 10+</p>
                    <p>æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒ</p>
                </div>
                <div class="arch-card">
                    <h4>ğŸ© CentOS/RHEL</h4>
                    <p>CentOS 7+ / RHEL 7+</p>
                    <p>ä¼ä¸šçº§æ”¯æŒ</p>
                </div>
                <div class="arch-card">
                    <h4>ğŸ¦ å…¶ä»–å‘è¡Œç‰ˆ</h4>
                    <p>Alpine, Arch, openSUSE</p>
                    <p>ç¤¾åŒºæµ‹è¯•æ”¯æŒ</p>
                </div>
            </div>

            <h3>ç¡¬ä»¶è¦æ±‚</h3>
            <table>
                <tr>
                    <th>ç»„ä»¶</th>
                    <th>æœ€ä½é…ç½®</th>
                    <th>æ¨èé…ç½®</th>
                    <th>è¯´æ˜</th>
                </tr>
                <tr>
                    <td>CPU</td>
                    <td>1 æ ¸å¿ƒ</td>
                    <td>2+ æ ¸å¿ƒ</td>
                    <td>eBPF éœ€è¦ç°ä»£ CPU æ”¯æŒ</td>
                </tr>
                <tr>
                    <td>å†…å­˜</td>
                    <td>512MB</td>
                    <td>1GB+</td>
                    <td>Agent çº¦å ç”¨ 50-100MB</td>
                </tr>
                <tr>
                    <td>ç£ç›˜</td>
                    <td>100MB</td>
                    <td>1GB+</td>
                    <td>æ—¥å¿—å’Œé…ç½®æ–‡ä»¶å­˜å‚¨</td>
                </tr>
                <tr>
                    <td>ç½‘ç»œ</td>
                    <td>-</td>
                    <td>åƒå…†ç½‘å¡</td>
                    <td>é«˜æµé‡ç¯å¢ƒæ¨è</td>
                </tr>
            </table>

            <h3>å†…æ ¸è¦æ±‚</h3>
            <div class="info">
                <strong>eBPF æ”¯æŒè¦æ±‚ï¼š</strong>
                <ul>
                    <li>Linux å†…æ ¸ç‰ˆæœ¬ â‰¥ 4.18 (æ¨è 5.4+)</li>
                    <li>å¯ç”¨ CONFIG_BPF=y</li>
                    <li>å¯ç”¨ CONFIG_BPF_SYSCALL=y</li>
                    <li>å¯ç”¨ CONFIG_BPF_JIT=y</li>
                </ul>
            </div>

            <div class="code-block">
<span class="comment"># æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬</span>
uname -r

<span class="comment"># æ£€æŸ¥ eBPF æ”¯æŒ</span>
zgrep CONFIG_BPF /proc/config.gz
zgrep CONFIG_BPF_SYSCALL /proc/config.gz

<span class="comment"># æˆ–è€…æ£€æŸ¥ /boot/config-$(uname -r)</span>
grep CONFIG_BPF /boot/config-$(uname -r)
            </div>
        </div>

        <div class="section" id="download">
            <h2>ğŸ“¥ ä¸‹è½½å®‰è£…</h2>
            
            <h3>æ–¹å¼ä¸€ï¼šç›´æ¥ä¸‹è½½ (æ¨è)</h3>
            <div class="code-block">
<span class="comment"># åˆ›å»ºå®‰è£…ç›®å½•</span>
sudo mkdir -p /opt/go-net-monitoring
cd /opt/go-net-monitoring

<span class="comment"># ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ (æ›¿æ¢ VERSION ä¸ºå®é™…ç‰ˆæœ¬å·)</span>
VERSION="v1.0.0"
wget https://github.com/zhoushoujianwork/go-net-monitoring/releases/download/${VERSION}/go-net-monitoring-linux-amd64.tar.gz

<span class="comment"># è§£å‹æ–‡ä»¶</span>
tar -xzf go-net-monitoring-linux-amd64.tar.gz

<span class="comment"># è®¾ç½®æ‰§è¡Œæƒé™</span>
chmod +x agent-ebpf server

<span class="comment"># éªŒè¯å®‰è£…</span>
./agent-ebpf --help
./server --help
            </div>

            <h3>æ–¹å¼äºŒï¼šä½¿ç”¨è„šæœ¬å®‰è£…</h3>
            <div class="code-block">
<span class="comment"># ä¸€é”®å®‰è£…è„šæœ¬</span>
curl -fsSL https://raw.githubusercontent.com/zhoushoujianwork/go-net-monitoring/main/scripts/install.sh | sudo bash

<span class="comment"># æˆ–è€…ä¸‹è½½åæ‰§è¡Œ</span>
wget https://raw.githubusercontent.com/zhoushoujianwork/go-net-monitoring/main/scripts/install.sh
chmod +x install.sh
sudo ./install.sh
            </div>

            <h3>æ–‡ä»¶ç»“æ„</h3>
            <div class="code-block">
/opt/go-net-monitoring/
â”œâ”€â”€ agent-ebpf              <span class="comment"># eBPF Agent ä¸»ç¨‹åº</span>
â”œâ”€â”€ server                  <span class="comment"># Server ä¸»ç¨‹åº</span>
â”œâ”€â”€ bpf/                    <span class="comment"># eBPF å­—èŠ‚ç æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ xdp_monitor.o
â”‚   â””â”€â”€ xdp_monitor_linux.o
â”œâ”€â”€ agent.yaml.example     <span class="comment"># Agent é…ç½®ç¤ºä¾‹</span>
â”œâ”€â”€ server.yaml.example    <span class="comment"># Server é…ç½®ç¤ºä¾‹</span>
â””â”€â”€ README.md              <span class="comment"># è¯´æ˜æ–‡æ¡£</span>
            </div>
        <div class="section" id="configuration">
            <h2>âš™ï¸ é…ç½®æ–‡ä»¶</h2>
            
            <h3>Agent é…ç½®</h3>
            <div class="code-block">
<span class="comment"># å¤åˆ¶é…ç½®æ–‡ä»¶</span>
sudo cp agent.yaml.example /etc/go-net-monitoring/agent.yaml

<span class="comment"># ç¼–è¾‘é…ç½®</span>
sudo nano /etc/go-net-monitoring/agent.yaml
            </div>

            <div class="highlight">
                <strong>Agent é…ç½®ç¤ºä¾‹ (agent.yaml)ï¼š</strong>
            </div>
            <div class="code-block">
monitor:
  interface: "eth0"          <span class="comment"># ç›‘æ§çš„ç½‘ç»œæ¥å£</span>
  protocols:
    - "tcp"
    - "udp"
    - "http"
    - "https"
  report_interval: "10s"     <span class="comment"># ä¸ŠæŠ¥é—´éš”</span>
  buffer_size: 1000          <span class="comment"># ç¼“å†²åŒºå¤§å°</span>
  filters:
    ignore_localhost: true
    ignore_ports:
      - 22    <span class="comment"># SSH</span>
      - 123   <span class="comment"># NTP</span>
    ignore_ips:
      - "127.0.0.1"
      - "::1"

reporter:
  server_url: "http://localhost:8080/api/v1/metrics"
  timeout: "10s"
  retry_count: 3
  batch_size: 100

log:
  level: "info"              <span class="comment"># debug, info, warn, error</span>
  format: "json"             <span class="comment"># json, text</span>
  output: "stdout"           <span class="comment"># stdout, file</span>
            </div>

            <h3>Server é…ç½®</h3>
            <div class="code-block">
<span class="comment"># å¤åˆ¶é…ç½®æ–‡ä»¶</span>
sudo cp server.yaml.example /etc/go-net-monitoring/server.yaml

<span class="comment"># ç¼–è¾‘é…ç½®</span>
sudo nano /etc/go-net-monitoring/server.yaml
            </div>

            <div class="highlight">
                <strong>Server é…ç½®ç¤ºä¾‹ (server.yaml)ï¼š</strong>
            </div>
            <div class="code-block">
http:
  host: "0.0.0.0"
  port: 8080
  read_timeout: "30s"
  write_timeout: "30s"
  enable_tls: false
  debug: false

storage:
  type: "memory"             <span class="comment"># memory æˆ– redis</span>
  
  <span class="comment"># Redis é…ç½® (å¯é€‰)</span>
  redis:
    host: "localhost"
    port: 6379
    password: ""
    db: 0
    pool_size: 10
    timeout: "5s"

metrics:
  path: "/metrics"
  enabled: true
  interval: "15s"

log:
  level: "info"
  format: "json"
  output: "stdout"
            </div>
        </div>

        <div class="section" id="deployment">
            <h2>ğŸš€ éƒ¨ç½²æ–¹å¼</h2>
            
            <h3>æ–¹å¼ä¸€ï¼šSystemd æœåŠ¡ (æ¨è)</h3>
            
            <h4>1. åˆ›å»ºæœåŠ¡ç”¨æˆ·</h4>
            <div class="code-block">
<span class="comment"># åˆ›å»ºç³»ç»Ÿç”¨æˆ·</span>
sudo useradd --system --no-create-home --shell /bin/false netmon

<span class="comment"># åˆ›å»ºé…ç½®ç›®å½•</span>
sudo mkdir -p /etc/go-net-monitoring
sudo mkdir -p /var/log/go-net-monitoring
sudo mkdir -p /var/lib/go-net-monitoring

<span class="comment"># è®¾ç½®æƒé™</span>
sudo chown -R netmon:netmon /var/log/go-net-monitoring
sudo chown -R netmon:netmon /var/lib/go-net-monitoring
sudo chown -R netmon:netmon /opt/go-net-monitoring
            </div>

            <h4>2. åˆ›å»º Server æœåŠ¡</h4>
            <div class="code-block">
<span class="comment"># åˆ›å»º systemd æœåŠ¡æ–‡ä»¶</span>
sudo tee /etc/systemd/system/netmon-server.service << 'EOF'
[Unit]
Description=Go Network Monitoring Server
Documentation=https://github.com/zhoushoujianwork/go-net-monitoring
After=network.target
Wants=network.target

[Service]
Type=simple
User=netmon
Group=netmon
ExecStart=/opt/go-net-monitoring/server --config /etc/go-net-monitoring/server.yaml
ExecReload=/bin/kill -HUP $MAINPID
Restart=always
RestartSec=5
StandardOutput=journal
StandardError=journal
SyslogIdentifier=netmon-server

# å®‰å…¨è®¾ç½®
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/log/go-net-monitoring /var/lib/go-net-monitoring

[Install]
WantedBy=multi-user.target
EOF
            </div>

            <h4>3. åˆ›å»º Agent æœåŠ¡</h4>
            <div class="code-block">
<span class="comment"># åˆ›å»º systemd æœåŠ¡æ–‡ä»¶</span>
sudo tee /etc/systemd/system/netmon-agent.service << 'EOF'
[Unit]
Description=Go Network Monitoring eBPF Agent
Documentation=https://github.com/zhoushoujianwork/go-net-monitoring
After=network.target netmon-server.service
Wants=network.target

[Service]
Type=simple
User=root
Group=root
ExecStart=/opt/go-net-monitoring/agent-ebpf --config /etc/go-net-monitoring/agent.yaml
ExecReload=/bin/kill -HUP $MAINPID
Restart=always
RestartSec=5
StandardOutput=journal
StandardError=journal
SyslogIdentifier=netmon-agent

# eBPF éœ€è¦ç‰¹æƒæƒé™
CapabilityBoundingSet=CAP_SYS_ADMIN CAP_NET_ADMIN CAP_BPF
AmbientCapabilities=CAP_SYS_ADMIN CAP_NET_ADMIN CAP_BPF

[Install]
WantedBy=multi-user.target
EOF
            </div>

            <h4>4. å¯åŠ¨æœåŠ¡</h4>
            <div class="code-block">
<span class="comment"># é‡æ–°åŠ è½½ systemd</span>
sudo systemctl daemon-reload

<span class="comment"># å¯åŠ¨å¹¶å¯ç”¨æœåŠ¡</span>
sudo systemctl enable netmon-server
sudo systemctl enable netmon-agent

sudo systemctl start netmon-server
sudo systemctl start netmon-agent

<span class="comment"># æ£€æŸ¥æœåŠ¡çŠ¶æ€</span>
sudo systemctl status netmon-server
sudo systemctl status netmon-agent
            </div>

            <h3>æ–¹å¼äºŒï¼šDocker éƒ¨ç½²</h3>
            <div class="code-block">
<span class="comment"># è¿è¡Œ Server</span>
docker run -d \
  --name netmon-server \
  -p 8080:8080 \
  -v /etc/go-net-monitoring:/etc/config:ro \
  zhoushoujianwork/go-net-monitoring:latest server

<span class="comment"># è¿è¡Œ Agent (éœ€è¦ç‰¹æƒæ¨¡å¼)</span>
docker run -d \
  --name netmon-agent \
  --privileged \
  --network host \
  -v /etc/go-net-monitoring:/etc/config:ro \
  zhoushoujianwork/go-net-monitoring:latest agent
            </div>

            <h3>æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨è¿è¡Œ</h3>
            <div class="code-block">
<span class="comment"># åå°è¿è¡Œ Server</span>
nohup /opt/go-net-monitoring/server \
  --config /etc/go-net-monitoring/server.yaml \
  > /var/log/go-net-monitoring/server.log 2>&1 &

<span class="comment"># åå°è¿è¡Œ Agent (éœ€è¦ root æƒé™)</span>
sudo nohup /opt/go-net-monitoring/agent-ebpf \
  --config /etc/go-net-monitoring/agent.yaml \
  > /var/log/go-net-monitoring/agent.log 2>&1 &
            </div>
        <div class="section" id="monitoring">
            <h2>ğŸ“Š ç›‘æ§éªŒè¯</h2>
            
            <h3>å¥åº·æ£€æŸ¥</h3>
            <div class="code-block">
<span class="comment"># æ£€æŸ¥ Server å¥åº·çŠ¶æ€</span>
curl http://localhost:8080/health

<span class="comment"># é¢„æœŸè¾“å‡º</span>
{"status":"ok","timestamp":"2025-01-01T12:00:00Z"}
            </div>

            <h3>æŸ¥çœ‹æŒ‡æ ‡æ•°æ®</h3>
            <div class="code-block">
<span class="comment"># æŸ¥çœ‹ Prometheus æŒ‡æ ‡</span>
curl http://localhost:8080/metrics

<span class="comment"># æŸ¥çœ‹ç½‘ç»œæµé‡æŒ‡æ ‡</span>
curl http://localhost:8080/metrics | grep network_

<span class="comment"># æŸ¥çœ‹åŸŸåè®¿é—®ç»Ÿè®¡</span>
curl http://localhost:8080/metrics | grep network_domains_accessed_total
            </div>

            <h3>æœåŠ¡çŠ¶æ€æ£€æŸ¥</h3>
            <div class="code-block">
<span class="comment"># æ£€æŸ¥æœåŠ¡çŠ¶æ€</span>
sudo systemctl status netmon-server
sudo systemctl status netmon-agent

<span class="comment"># æŸ¥çœ‹æœåŠ¡æ—¥å¿—</span>
sudo journalctl -u netmon-server -f
sudo journalctl -u netmon-agent -f

<span class="comment"># æ£€æŸ¥ç«¯å£ç›‘å¬</span>
sudo netstat -tlnp | grep 8080
sudo ss -tlnp | grep 8080
            </div>

            <h3>æ€§èƒ½ç›‘æ§</h3>
            <div class="code-block">
<span class="comment"># æ£€æŸ¥è¿›ç¨‹èµ„æºä½¿ç”¨</span>
ps aux | grep -E "(agent-ebpf|server)"

<span class="comment"># æ£€æŸ¥å†…å­˜ä½¿ç”¨</span>
sudo pmap -x $(pgrep agent-ebpf)
sudo pmap -x $(pgrep server)

<span class="comment"># æ£€æŸ¥ç½‘ç»œè¿æ¥</span>
sudo lsof -i :8080
sudo lsof -p $(pgrep agent-ebpf)
            </div>
        </div>

        <div class="section" id="troubleshooting">
            <h2>ğŸ”§ æ•…éšœæ’æŸ¥</h2>
            
            <h3>å¸¸è§é—®é¢˜</h3>
            
            <h4>1. eBPF ç¨‹åºåŠ è½½å¤±è´¥</h4>
            <div class="warning">
                <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "failed to load collection spec: open bin/bpf/xdp_monitor.o: no such file or directory"
            </div>
            
            <div class="code-block">
<span class="comment"># æ£€æŸ¥ eBPF æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
ls -la /opt/go-net-monitoring/bpf/

<span class="comment"># æ£€æŸ¥æ–‡ä»¶æƒé™</span>
sudo chmod 644 /opt/go-net-monitoring/bpf/*.o

<span class="comment"># æ£€æŸ¥å†…æ ¸ eBPF æ”¯æŒ</span>
zgrep CONFIG_BPF /proc/config.gz
            </div>

            <h4>2. æƒé™ä¸è¶³</h4>
            <div class="warning">
                <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "operation not permitted" æˆ– "permission denied"
            </div>
            
            <div class="code-block">
<span class="comment"># Agent éœ€è¦ root æƒé™è¿è¡Œ</span>
sudo /opt/go-net-monitoring/agent-ebpf --config /etc/go-net-monitoring/agent.yaml

<span class="comment"># æˆ–è€…è®¾ç½® capabilities</span>
sudo setcap cap_sys_admin,cap_net_admin,cap_bpf+ep /opt/go-net-monitoring/agent-ebpf
            </div>

            <h4>3. ç½‘ç»œæ¥å£ä¸å­˜åœ¨</h4>
            <div class="warning">
                <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "network interface not found"
            </div>
            
            <div class="code-block">
<span class="comment"># æŸ¥çœ‹å¯ç”¨ç½‘ç»œæ¥å£</span>
ip link show
ifconfig -a

<span class="comment"># æ›´æ–°é…ç½®æ–‡ä»¶ä¸­çš„æ¥å£åç§°</span>
sudo nano /etc/go-net-monitoring/agent.yaml
            </div>

            <h4>4. Server è¿æ¥å¤±è´¥</h4>
            <div class="warning">
                <strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> "connection refused" æˆ– "timeout"
            </div>
            
            <div class="code-block">
<span class="comment"># æ£€æŸ¥ Server æ˜¯å¦è¿è¡Œ</span>
sudo systemctl status netmon-server

<span class="comment"># æ£€æŸ¥é˜²ç«å¢™è®¾ç½®</span>
sudo ufw status
sudo iptables -L

<span class="comment"># æ£€æŸ¥ Server URL é…ç½®</span>
grep server_url /etc/go-net-monitoring/agent.yaml
            </div>

            <h3>æ—¥å¿—åˆ†æ</h3>
            <div class="code-block">
<span class="comment"># æŸ¥çœ‹è¯¦ç»†æ—¥å¿—</span>
sudo journalctl -u netmon-agent --since "1 hour ago"
sudo journalctl -u netmon-server --since "1 hour ago"

<span class="comment"># å¯ç”¨è°ƒè¯•æ—¥å¿—</span>
sudo systemctl edit netmon-agent
<span class="comment"># æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</span>
[Service]
ExecStart=
ExecStart=/opt/go-net-monitoring/agent-ebpf --debug --config /etc/go-net-monitoring/agent.yaml
            </div>

            <h3>æ€§èƒ½è°ƒä¼˜</h3>
            <div class="info">
                <strong>é«˜æµé‡ç¯å¢ƒä¼˜åŒ–å»ºè®®ï¼š</strong>
                <ul>
                    <li>å¢åŠ  buffer_size åˆ° 10000+</li>
                    <li>è°ƒæ•´ report_interval åˆ° 30s+</li>
                    <li>å¢åŠ  batch_size åˆ° 1000+</li>
                    <li>ä½¿ç”¨ Redis ä½œä¸ºå­˜å‚¨åç«¯</li>
                </ul>
            </div>
        </div>

        <div class="section" id="advanced">
            <h2>ğŸ”¬ é«˜çº§é…ç½®</h2>
            
            <h3>å¤šèŠ‚ç‚¹éƒ¨ç½²</h3>
            <div class="code-block">
<span class="comment"># ä¸­å¿ƒåŒ– Server éƒ¨ç½²</span>
<span class="comment"># Server èŠ‚ç‚¹ (192.168.1.100)</span>
http:
  host: "0.0.0.0"
  port: 8080

<span class="comment"># Agent èŠ‚ç‚¹é…ç½®</span>
reporter:
  server_url: "http://192.168.1.100:8080/api/v1/metrics"
            </div>

            <h3>è´Ÿè½½å‡è¡¡é…ç½®</h3>
            <div class="code-block">
<span class="comment"># Nginx é…ç½®ç¤ºä¾‹</span>
upstream netmon_servers {
    server 192.168.1.100:8080;
    server 192.168.1.101:8080;
    server 192.168.1.102:8080;
}

server {
    listen 80;
    server_name netmon.example.com;
    
    location / {
        proxy_pass http://netmon_servers;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
            </div>

            <h3>Prometheus é›†æˆ</h3>
            <div class="code-block">
<span class="comment"># prometheus.yml é…ç½®</span>
scrape_configs:
  - job_name: 'go-net-monitoring'
    static_configs:
      - targets: ['localhost:8080']
    scrape_interval: 15s
    metrics_path: /metrics
            </div>

            <h3>Grafana Dashboard</h3>
            <div class="info">
                <strong>é¢„ç½® Dashboardï¼š</strong>
                <ul>
                    <li>ç½‘ç»œæµé‡æ€»è§ˆ - ID: 12345</li>
                    <li>åŸŸåè®¿é—®ç»Ÿè®¡ - ID: 12346</li>
                    <li>åè®®åˆ†æé¢æ¿ - ID: 12347</li>
                </ul>
            </div>

            <h3>å‘Šè­¦è§„åˆ™</h3>
            <div class="code-block">
<span class="comment"># Prometheus å‘Šè­¦è§„åˆ™ç¤ºä¾‹</span>
groups:
  - name: network_monitoring
    rules:
      - alert: HighNetworkTraffic
        expr: rate(network_bytes_sent_total[5m]) > 100000000
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High network traffic detected"
          
      - alert: AgentDown
        expr: up{job="go-net-monitoring"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Network monitoring agent is down"
            </div>
        </div>

        <div class="footer">
            <p>Â© 2025 Go Network Monitoring Project</p>
            <p>
                <a href="https://github.com/zhoushoujianwork/go-net-monitoring">GitHub</a> |
                <a href="https://github.com/zhoushoujianwork/go-net-monitoring/issues">Issues</a> |
                <a href="https://github.com/zhoushoujianwork/go-net-monitoring/wiki">Wiki</a>
            </p>
        </div>
    </div>
</body>
</html>
