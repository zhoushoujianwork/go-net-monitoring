<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¹å™¨è¿è¡Œ Agent éƒ¨ç½²æŒ‡å— - Go ç½‘ç»œç›‘æ§ç³»ç»Ÿ</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            border-left: 4px solid #28a745;
        }
        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin: 8px 0;
        }
        .toc a {
            color: #3498db;
            text-decoration: none;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .emoji {
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">ğŸ³</span> å®¹å™¨è¿è¡Œ Agent éƒ¨ç½²æŒ‡å—</h1>
        
        <div class="info">
            <strong>ğŸ“‹ æ–‡æ¡£æ¦‚è¿°ï¼š</strong> æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Docker å®¹å™¨æ–¹å¼éƒ¨ç½²å’Œè¿è¡Œç½‘ç»œç›‘æ§ Agentï¼ŒåŒ…æ‹¬å•ç‹¬éƒ¨ç½²ã€é›†ç¾¤éƒ¨ç½²å’Œæ•…éšœæ’æŸ¥ç­‰å†…å®¹ã€‚
        </div>

        <div class="toc">
            <h3>ğŸ“‘ ç›®å½•</h3>
            <ul>
                <li><a href="#overview">1. æ¦‚è¿°</a></li>
                <li><a href="#prerequisites">2. ç¯å¢ƒè¦æ±‚</a></li>
                <li><a href="#quick-start">3. å¿«é€Ÿå¼€å§‹</a></li>
                <li><a href="#standalone-deployment">4. ç‹¬ç«‹ Agent éƒ¨ç½²</a></li>
                <li><a href="#configuration">5. é…ç½®ç®¡ç†</a></li>
                <li><a href="#monitoring">6. ç›‘æ§éªŒè¯</a></li>
                <li><a href="#troubleshooting">7. æ•…éšœæ’æŸ¥</a></li>
                <li><a href="#best-practices">8. æœ€ä½³å®è·µ</a></li>
            </ul>
        </div>

        <h2 id="overview"><span class="emoji">ğŸ¯</span> 1. æ¦‚è¿°</h2>
        
        <p>Go ç½‘ç»œç›‘æ§ç³»ç»Ÿçš„ Agent ç»„ä»¶è´Ÿè´£å®æ—¶æ”¶é›†ç½‘ç»œæµé‡æ•°æ®ï¼ŒåŒ…æ‹¬åŸŸåè®¿é—®ç»Ÿè®¡ã€åè®®åˆ†æå’Œæµé‡ç›‘æ§ã€‚å®¹å™¨åŒ–éƒ¨ç½²æ–¹å¼å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>

        <div class="feature-list">
            <div class="feature-item">
                <h4><span class="emoji">ğŸš€</span> å¿«é€Ÿéƒ¨ç½²</h4>
                <p>ä¸€é”®å¯åŠ¨ï¼Œæ— éœ€å¤æ‚çš„ç¯å¢ƒé…ç½®å’Œä¾èµ–å®‰è£…</p>
            </div>
            <div class="feature-item">
                <h4><span class="emoji">ğŸ”§</span> ç»Ÿä¸€ç¯å¢ƒ</h4>
                <p>è§£å†³ CGO ä¾èµ–å’Œè·¨å¹³å°å…¼å®¹æ€§é—®é¢˜</p>
            </div>
            <div class="feature-item">
                <h4><span class="emoji">ğŸ“Š</span> å®æ—¶ç›‘æ§</h4>
                <p>åŸºäº eBPF çš„é«˜æ€§èƒ½ç½‘ç»œæ•°æ®åŒ…æ•è·</p>
            </div>
            <div class="feature-item">
                <h4><span class="emoji">ğŸŒ</span> æ™ºèƒ½è§£æ</h4>
                <p>è‡ªåŠ¨ DNS è§£æå’ŒåŸŸåè®¿é—®ç»Ÿè®¡</p>
            </div>
        </div>

        <h2 id="prerequisites"><span class="emoji">âš™ï¸</span> 2. ç¯å¢ƒè¦æ±‚</h2>

        <h3>ç³»ç»Ÿè¦æ±‚</h3>
        <table>
            <tr>
                <th>ç»„ä»¶</th>
                <th>è¦æ±‚</th>
                <th>è¯´æ˜</th>
            </tr>
            <tr>
                <td>Docker</td>
                <td>â‰¥ 20.10</td>
                <td>æ”¯æŒå®¹å™¨è¿è¡Œæ—¶</td>
            </tr>
            <tr>
                <td>æ“ä½œç³»ç»Ÿ</td>
                <td>Linux/macOS/Windows</td>
                <td>æ¨è Linux è·å¾—æœ€ä½³æ€§èƒ½</td>
            </tr>
            <tr>
                <td>å†…å­˜</td>
                <td>â‰¥ 512MB</td>
                <td>Agent è¿è¡Œæ‰€éœ€æœ€å°å†…å­˜</td>
            </tr>
            <tr>
                <td>ç½‘ç»œæƒé™</td>
                <td>ç‰¹æƒæ¨¡å¼</td>
                <td>éœ€è¦ --privileged è¿›è¡Œç½‘ç»œç›‘æ§</td>
            </tr>
        </table>

        <h3>æƒé™è¦æ±‚</h3>
        <div class="warning">
            <strong>âš ï¸ é‡è¦æé†’ï¼š</strong> Agent éœ€è¦ç‰¹æƒæ¨¡å¼ (<code>--privileged</code>) æ‰èƒ½è¿›è¡Œç½‘ç»œæ•°æ®åŒ…æ•è·å’Œ eBPF ç¨‹åºåŠ è½½ã€‚è¿™æ˜¯ç½‘ç»œç›‘æ§çš„å¿…è¦æƒé™ã€‚
        </div>

        <h3>ç½‘ç»œè¦æ±‚</h3>
        <ul>
            <li><strong>Server è¿æ¥ï¼š</strong> Agent éœ€è¦èƒ½å¤Ÿè®¿é—® Server çš„ API ç«¯ç‚¹</li>
            <li><strong>DNS è§£æï¼š</strong> éœ€è¦ DNS æœåŠ¡è¿›è¡ŒåŸŸåè§£æ</li>
            <li><strong>ç½‘ç»œæ¥å£ï¼š</strong> è‡³å°‘æœ‰ä¸€ä¸ªå¯ç›‘æ§çš„ç½‘ç»œæ¥å£</li>
        </ul>

        <h2 id="quick-start"><span class="emoji">ğŸš€</span> 3. å¿«é€Ÿå¼€å§‹</h2>

        <h3>ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰</h3>
        <p>ä½¿ç”¨é¡¹ç›®æä¾›çš„è„šæœ¬å¿«é€Ÿå¯åŠ¨å®Œæ•´çš„ç›‘æ§æ ˆï¼š</p>

        <div class="code-block">
# å…‹éš†é¡¹ç›®
git clone https://github.com/zhoushoujianwork/go-net-monitoring.git
cd go-net-monitoring

# ä¸€é”®å¯åŠ¨ï¼ˆåŒ…å« Agent + Server + ç›‘æ§æ ˆï¼‰
./run.sh
        </div>

        <div class="success">
            <strong>âœ… å¯åŠ¨æˆåŠŸåï¼š</strong>
            <ul>
                <li>Agent: è‡ªåŠ¨å¼€å§‹ç½‘ç»œç›‘æ§</li>
                <li>Server: http://localhost:8080</li>
                <li>Prometheus: http://localhost:9090 (å¦‚æœå¯ç”¨ç›‘æ§æ ˆ)</li>
                <li>Grafana: http://localhost:3000 (admin/admin123)</li>
            </ul>
        </div>

        <h3>Docker Compose æ–¹å¼</h3>
        <div class="code-block">
# å¯åŠ¨åŸºç¡€æœåŠ¡ï¼ˆAgent + Serverï¼‰
docker-compose up -d

# å¯åŠ¨å®Œæ•´ç›‘æ§æ ˆï¼ˆåŒ…å« Prometheus + Grafanaï¼‰
docker-compose --profile monitoring up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
        </div>

        <h3>éªŒè¯éƒ¨ç½²</h3>
        <div class="code-block">
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps | grep netmon

# æ£€æŸ¥ Agent å¥åº·çŠ¶æ€
docker logs netmon-agent | tail -10

# æŸ¥çœ‹ç›‘æ§æŒ‡æ ‡
curl http://localhost:8080/metrics | grep network_
        </div>

        <h2 id="standalone-deployment"><span class="emoji">ğŸ¯</span> 4. ç‹¬ç«‹ Agent éƒ¨ç½²</h2>

        <h3>åœºæ™¯è¯´æ˜</h3>
        <p>å½“ä½ éœ€è¦åœ¨å¤šä¸ªä¸»æœºä¸Šéƒ¨ç½² Agentï¼Œæˆ–è€… Server å·²ç»åœ¨å…¶ä»–åœ°æ–¹è¿è¡Œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç‹¬ç«‹ Agent éƒ¨ç½²æ–¹å¼ã€‚</p>

        <h3>æ­¥éª¤ 1: å¯åŠ¨ Server</h3>
        <div class="code-block">
# å¯åŠ¨ Server å®¹å™¨
docker run -d \
  --name netmon-server \
  -p 8080:8080 \
  -e COMPONENT=server \
  zhoushoujian/go-net-monitoring:latest

# éªŒè¯ Server å¯åŠ¨
curl http://localhost:8080/health
        </div>

        <h3>æ­¥éª¤ 2: å¯åŠ¨ Agent</h3>
        <div class="code-block">
# åŸºç¡€ Agent éƒ¨ç½²
docker run -d \
  --name netmon-agent \
  --privileged \
  --network host \
  -e COMPONENT=agent \
  -e SERVER_URL=http://localhost:8080/api/v1/metrics \
  zhoushoujian/go-net-monitoring:latest
        </div>

        <h3>æ­¥éª¤ 3: é«˜çº§é…ç½®</h3>
        <div class="code-block">
# å¸¦å®Œæ•´é…ç½®çš„ Agent éƒ¨ç½²
docker run -d \
  --name netmon-agent \
  --privileged \
  --network host \
  -e COMPONENT=agent \
  -e SERVER_URL=http://your-server:8080/api/v1/metrics \
  -e HOSTNAME=agent-host-1 \
  -e LOG_LEVEL=debug \
  -e NETWORK_INTERFACE=eth0 \
  -v /var/log/netmon:/app/logs \
  -v /var/lib/netmon:/var/lib/netmon \
  zhoushoujian/go-net-monitoring:latest
        </div>

        <h2 id="configuration"><span class="emoji">âš™ï¸</span> 5. é…ç½®ç®¡ç†</h2>

        <h3>ç¯å¢ƒå˜é‡é…ç½®</h3>
        <table>
            <tr>
                <th>å˜é‡å</th>
                <th>é»˜è®¤å€¼</th>
                <th>è¯´æ˜</th>
            </tr>
            <tr>
                <td>COMPONENT</td>
                <td>agent</td>
                <td>ç»„ä»¶ç±»å‹ï¼Œå¿…é¡»è®¾ç½®ä¸º "agent"</td>
            </tr>
            <tr>
                <td>SERVER_URL</td>
                <td>http://localhost:8080/api/v1/metrics</td>
                <td>Server API ç«¯ç‚¹åœ°å€</td>
            </tr>
            <tr>
                <td>HOSTNAME</td>
                <td>å®¹å™¨ID</td>
                <td>Agent ä¸»æœºåæ ‡è¯†</td>
            </tr>
            <tr>
                <td>LOG_LEVEL</td>
                <td>info</td>
                <td>æ—¥å¿—çº§åˆ«ï¼šdebug, info, warn, error</td>
            </tr>
            <tr>
                <td>NETWORK_INTERFACE</td>
                <td>è‡ªåŠ¨æ£€æµ‹</td>
                <td>ç›‘æ§çš„ç½‘ç»œæ¥å£åç§°</td>
            </tr>
            <tr>
                <td>DEBUG_MODE</td>
                <td>false</td>
                <td>æ˜¯å¦å¯ç”¨è°ƒè¯•æ¨¡å¼</td>
            </tr>
        </table>

        <h3>é…ç½®æ–‡ä»¶æ–¹å¼</h3>
        <div class="code-block">
# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > agent-config.yaml << EOF
server:
  host: "your-server-host"
  port: 8080

monitor:
  interface: "eth0"
  protocols: ["tcp", "udp", "http", "https"]
  report_interval: "10s"
  
reporter:
  server_url: "http://your-server:8080/api/v1/metrics"
  timeout: "10s"
  batch_size: 100

log:
  level: "info"
  format: "json"
EOF

# ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨
docker run -d \
  --name netmon-agent \
  --privileged \
  --network host \
  -e COMPONENT=agent \
  -v $(pwd)/agent-config.yaml:/app/configs/agent.yaml:ro \
  zhoushoujian/go-net-monitoring:latest
        </div>

        <h2 id="monitoring"><span class="emoji">ğŸ“Š</span> 6. ç›‘æ§éªŒè¯</h2>

        <h3>æ£€æŸ¥ Agent çŠ¶æ€</h3>
        <div class="code-block">
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps | grep netmon-agent

# æŸ¥çœ‹ Agent æ—¥å¿—
docker logs netmon-agent

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker logs -f netmon-agent
        </div>

        <h3>éªŒè¯æ•°æ®ä¸ŠæŠ¥</h3>
        <div class="code-block">
# æ£€æŸ¥åŸºç¡€æŒ‡æ ‡
curl -s http://localhost:8080/metrics | grep network_connections_total

# æ£€æŸ¥åŸŸåè®¿é—®ç»Ÿè®¡
curl -s http://localhost:8080/metrics | grep network_domains_accessed_total

# æ£€æŸ¥æµé‡ç»Ÿè®¡
curl -s http://localhost:8080/metrics | grep network_domain_bytes

# æ£€æŸ¥ç½‘å¡ä¿¡æ¯
curl -s http://localhost:8080/metrics | grep network_interface_info
        </div>

        <h3>ç”Ÿæˆæµ‹è¯•æµé‡</h3>
        <div class="code-block">
# åœ¨ Agent å®¹å™¨å†…ç”Ÿæˆæµ‹è¯•æµé‡
docker exec netmon-agent sh -c "curl -s https://www.google.com > /dev/null"
docker exec netmon-agent sh -c "ping -c 3 8.8.8.8"

# ç­‰å¾…æ•°æ®ä¸ŠæŠ¥ï¼ˆé»˜è®¤10ç§’é—´éš”ï¼‰
sleep 15

# æŸ¥çœ‹æ–°çš„åŸŸåç»Ÿè®¡
curl -s http://localhost:8080/metrics | grep "www.google.com"
        </div>

        <h2 id="troubleshooting"><span class="emoji">ğŸ”§</span> 7. æ•…éšœæ’æŸ¥</h2>

        <h3>å¸¸è§é—®é¢˜</h3>
        
        <h4>é—®é¢˜ 1: Agent å®¹å™¨å¯åŠ¨å¤±è´¥</h4>
        <div class="warning">
            <strong>ç—‡çŠ¶ï¼š</strong> å®¹å™¨æ— æ³•å¯åŠ¨æˆ–ç«‹å³é€€å‡º
        </div>
        <div class="code-block">
# æ£€æŸ¥å®¹å™¨æ—¥å¿—
docker logs netmon-agent

# æ£€æŸ¥æ˜¯å¦ç¼ºå°‘ç‰¹æƒæ¨¡å¼
docker run --rm --privileged --network host \
  -e COMPONENT=agent \
  zhoushoujian/go-net-monitoring:latest
        </div>

        <h4>é—®é¢˜ 2: æ— æ³•è¿æ¥åˆ° Server</h4>
        <div class="warning">
            <strong>ç—‡çŠ¶ï¼š</strong> Agent æ—¥å¿—æ˜¾ç¤ºè¿æ¥é”™è¯¯
        </div>
        <div class="code-block">
# æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
docker exec netmon-agent curl -v http://your-server:8080/health

# æ£€æŸ¥ SERVER_URL é…ç½®
docker inspect netmon-agent | grep SERVER_URL
        </div>

        <h4>é—®é¢˜ 3: æ²¡æœ‰ç½‘ç»œæ•°æ®</h4>
        <div class="warning">
            <strong>ç—‡çŠ¶ï¼š</strong> æŒ‡æ ‡æ˜¾ç¤ºä¸º 0 æˆ–æ²¡æœ‰åŸŸåç»Ÿè®¡
        </div>
        <div class="code-block">
# æ£€æŸ¥ç½‘ç»œæ¥å£
docker exec netmon-agent ip addr show

# æ£€æŸ¥ eBPF æ”¯æŒ
docker exec netmon-agent dmesg | grep -i bpf

# ç”Ÿæˆæµ‹è¯•æµé‡
docker exec netmon-agent curl -s https://httpbin.org/get
        </div>

        <h3>è°ƒè¯•æ¨¡å¼</h3>
        <div class="code-block">
# å¯ç”¨è°ƒè¯•æ¨¡å¼
docker run -d \
  --name netmon-agent-debug \
  --privileged \
  --network host \
  -e COMPONENT=agent \
  -e DEBUG_MODE=true \
  -e LOG_LEVEL=debug \
  zhoushoujian/go-net-monitoring:latest

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker logs -f netmon-agent-debug
        </div>

        <h2 id="best-practices"><span class="emoji">ğŸ’¡</span> 8. æœ€ä½³å®è·µ</h2>

        <h3>ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²</h3>
        <ul>
            <li><strong>èµ„æºé™åˆ¶ï¼š</strong> è®¾ç½®åˆé€‚çš„ CPU å’Œå†…å­˜é™åˆ¶</li>
            <li><strong>æ—¥å¿—ç®¡ç†ï¼š</strong> é…ç½®æ—¥å¿—è½®è½¬å’ŒæŒä¹…åŒ–å­˜å‚¨</li>
            <li><strong>ç›‘æ§å‘Šè­¦ï¼š</strong> è®¾ç½® Agent å¥åº·æ£€æŸ¥å’Œå‘Šè­¦</li>
            <li><strong>ç½‘ç»œå®‰å…¨ï¼š</strong> é™åˆ¶ Agent çš„ç½‘ç»œè®¿é—®æƒé™</li>
        </ul>

        <div class="code-block">
# ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®
docker run -d \
  --name netmon-agent \
  --privileged \
  --network host \
  --restart unless-stopped \
  --memory 512m \
  --cpus 0.5 \
  -e COMPONENT=agent \
  -e SERVER_URL=https://monitoring.company.com/api/v1/metrics \
  -e HOSTNAME=$(hostname) \
  -e LOG_LEVEL=info \
  -v /var/log/netmon:/app/logs \
  -v /var/lib/netmon:/var/lib/netmon \
  --log-driver json-file \
  --log-opt max-size=100m \
  --log-opt max-file=3 \
  zhoushoujian/go-net-monitoring:latest
        </div>

        <h3>æ€§èƒ½ä¼˜åŒ–</h3>
        <ul>
            <li><strong>æ¥å£é€‰æ‹©ï¼š</strong> æŒ‡å®šå…·ä½“çš„ç½‘ç»œæ¥å£è€Œä¸æ˜¯ç›‘æ§æ‰€æœ‰æ¥å£</li>
            <li><strong>ä¸ŠæŠ¥é—´éš”ï¼š</strong> æ ¹æ®éœ€æ±‚è°ƒæ•´æ•°æ®ä¸ŠæŠ¥é¢‘ç‡</li>
            <li><strong>è¿‡æ»¤è§„åˆ™ï¼š</strong> é…ç½®åˆé€‚çš„æµé‡è¿‡æ»¤è§„åˆ™</li>
            <li><strong>æ‰¹é‡å¤§å°ï¼š</strong> ä¼˜åŒ–æ‰¹é‡ä¸ŠæŠ¥çš„æ•°æ®å¤§å°</li>
        </ul>

        <h3>å®‰å…¨è€ƒè™‘</h3>
        <div class="info">
            <strong>ğŸ”’ å®‰å…¨æé†’ï¼š</strong>
            <ul>
                <li>Agent éœ€è¦ç‰¹æƒæ¨¡å¼ï¼Œè¯·ç¡®ä¿åœ¨å¯ä¿¡ç¯å¢ƒä¸­è¿è¡Œ</li>
                <li>å®šæœŸæ›´æ–°é•œåƒç‰ˆæœ¬ä»¥è·å–å®‰å…¨è¡¥ä¸</li>
                <li>ä½¿ç”¨ HTTPS è¿æ¥ Server ä»¥ä¿æŠ¤æ•°æ®ä¼ è¾“</li>
                <li>é™åˆ¶ Agent å®¹å™¨çš„ç½‘ç»œè®¿é—®èŒƒå›´</li>
            </ul>
        </div>

        <h3>ç›‘æ§å’Œç»´æŠ¤</h3>
        <div class="code-block">
# å®šæœŸæ£€æŸ¥è„šæœ¬
#!/bin/bash
# check-agent.sh

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
if ! docker ps | grep -q netmon-agent; then
    echo "Agent å®¹å™¨æœªè¿è¡Œï¼Œå°è¯•é‡å¯..."
    docker start netmon-agent
fi

# æ£€æŸ¥æ•°æ®ä¸ŠæŠ¥
METRICS=$(curl -s http://localhost:8080/metrics | grep network_connections_total | wc -l)
if [ "$METRICS" -eq 0 ]; then
    echo "è­¦å‘Šï¼šæ²¡æœ‰æ£€æµ‹åˆ°ç½‘ç»œæŒ‡æ ‡æ•°æ®"
fi

# æ£€æŸ¥æ—¥å¿—é”™è¯¯
ERRORS=$(docker logs netmon-agent --since 1h | grep -i error | wc -l)
if [ "$ERRORS" -gt 0 ]; then
    echo "è­¦å‘Šï¼šå‘ç° $ERRORS ä¸ªé”™è¯¯æ—¥å¿—"
fi
        </div>

        <div class="success">
            <h3><span class="emoji">ğŸ‰</span> éƒ¨ç½²å®Œæˆ</h3>
            <p>æ­å–œï¼ä½ å·²ç»æˆåŠŸéƒ¨ç½²äº†å®¹å™¨åŒ–çš„ç½‘ç»œç›‘æ§ Agentã€‚Agent ç°åœ¨æ­£åœ¨æ”¶é›†ç½‘ç»œæµé‡æ•°æ®å¹¶ä¸ŠæŠ¥åˆ° Serverã€‚</p>
            <p>æ¥ä¸‹æ¥ä½ å¯ä»¥ï¼š</p>
            <ul>
                <li>è®¿é—® Grafana Dashboard æŸ¥çœ‹å¯è§†åŒ–ç›‘æ§æ•°æ®</li>
                <li>é…ç½® Prometheus å‘Šè­¦è§„åˆ™</li>
                <li>éƒ¨ç½²æ›´å¤š Agent åˆ°å…¶ä»–ä¸»æœº</li>
                <li>æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ç›‘æ§é…ç½®</li>
            </ul>
        </div>

        <hr>
        <p><em>ğŸ“ æ–‡æ¡£æ›´æ–°æ—¶é—´ï¼š2025-07-08 | ç‰ˆæœ¬ï¼šv1.0</em></p>
    </div>
</body>
</html>
